<!DOCTYPE html>
<html>
<head>
<meta charset="ISO-8859-1">



<title>Discounts</title>
<link href=".css.css" rel="stylesheet" type="text/css">
<style>
@media print {  /* adjusted to print the html to a single-page pdf */
body {
	font-size: 8pt;
}
</style>
</head>
<body>


<h1>Discounts</h1>	
<p>
The program simulates the management of discounts in a large supermarket.
All the classes are in the package <b>it.polito.oop.discounts</b>. 
The main class is <b>Discounts</b>. Class <b>TestApp</b> in package <i>example</i>
contains simple test.
All exception thrown belong to class <b>DiscountsException</b>.
<p>
The JDK documentation is available at URL <a href="https://oop.polito.it/api/index.html">http://softeng.polito.it/courses/docs/api/index.html</a>. 

</p>

<h2>R1: Cards </h2>
<p>
To get a discount a customer must own a card.
A card can be obtained with the method <b>issueCard()</b> that accepts the name of the client and returns a progressive number starting from 1 (included).

<p>
To know the name of the owner of the card the method <b>cardHolder()</b> is used, it accepts the number of the card and
returns the name of the client.
<p>
To get the total amount of cards issued we can use the method <b>nOfCards()</b>.



<h2>R2: Products </h2> 

<p>
To register a product type in the supermarket we can use method <b>addProduct(String, String, double)</b>.
The first argument is the category code (e.g. Drinks), the second is the product code and the latter is the price.
The method raises and exception if the product code is already defined.
<p>
The method <b>getPrice(String)</b> returns the product for a given product code;
if the code is undefined it raises and exception.
<p>
The method <b>getAveragePrice(String)</b> returns the rounded average price, of all products in the given category;
if the category is undefined (i.e. it has no products) it raises and exception.


 
<h2>R3: Discounts </h2> 
<p>
Discounts can be defined at the category level and apply to all products belonging to the category.
Initially all categories have a discount equal to 0%.
<p>
The method <b>setDiscount(String, int)</b> assigns a discount percentage (integer value between 0 and 50, limits included)
to the category passed as first argument;
it raises and exception if the category is undefined or the discount is not in the valid range).
<p>
The method <b>getDiscount(String)</b> returns the discount assigned to a given category.


<h2>R4: Purchases </h2> 

<p>
Purchases can be performed with or without a card.
In the former case the method <b>addPurchase(int, String..)</b> is used, which has the card code as first argument.
In the latter case the method to be used is <b>addPurchase(String..)</b>.
<p>
The argument(s) <i>String...</i> represents the purchased items.
Every item is a string containing the product code and the number of units, separated by character <i>":"</i>
without any additional spacing.  
<p>
Both methods return a progressive purchase code (starting from 1).
 <p>
 The above two methods record the total amount of the purchase that is equal to the sum of all item prices;
 the price of an item is given by the product price multiplied by the number of units.
 When a card is used for the purchase the method applies a discount based on the product categories: 
 for each item the discount is the one for the category of the product.
 <p>
 Both methods raise ans exception if they include when an undefined product code is found.
 <p>
 The method  <b>getAmount(int)</b>, given the purchase code, returns the total of the purchase after applying the possible discount. 
 <p>
 The method <b>getDiscount(int)</b> provides the discount applied for a given purchase code.
<p> 
The method <b>getNofUnits(int)</b> returns the number of units present in a given purchase.



<h2>R5: Statistics </h2> 

<p>
The method <b>productIdsPerNofUnits()</b> returns the list of product codes per number of units purchased.
Only products with at least one purchased unit are considered.
The key of the map (number of items) are sorted in ascending order and the product code lists are sorted alphabetically.
<p>
The method <b>totalPurchasePerCard()</b> returns the total amount purchased per card.
Only cards that performed at least one purchase are considered.
The keys (card numbers) are sorted in ascending order, the total amounts are rounded.
<p>
The method <b>totalPurchaseWithoutCard()</b> returns the total amount of purchases performed without cards.
<p>
The method <b>totalDiscountPerCard()</b> returns the total discount per card.
Only cards that performed at least one purchase with discount greater than zero are considered.
Keys are sorted in ascending order.
<p>

</body>
</html>